<!doctype html>
<html lang="en" class="govuk-template no-js">
  <head>
    <meta content="IE=edge" http-equiv="X-UA-Compatible">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <title>Working with LPA GIS Systems - Planning Data</title>

    <link href="stylesheets/manifest.css" rel="stylesheet" />

    <link rel="canonical" href="digital-land.github.io/WorkingWithLPA_GIS.html">

      <meta name="robots" content="noindex" />
      <meta name="twitter:card" content="summary" />
      <meta name="twitter:image" content="digital-land.github.io/images/govuk-large.png" />
      <meta name="twitter:title" content="Working with LPA GIS Systems - Planning Data" />
      <meta name="twitter:url" content="digital-land.github.io/WorkingWithLPA_GIS.html" />

      <meta property="og:image" content="digital-land.github.io/images/govuk-large.png" />
      <meta property="og:site_name" content="Planning Data" />
      <meta property="og:title" content="Working with LPA GIS Systems" />
      <meta property="og:type" content="object" />
      <meta property="og:url" content="digital-land.github.io/WorkingWithLPA_GIS.html" />

    
  </head>

  <body class="govuk-template__body">
    <script>document.body.className = ((document.body.className) ? document.body.className + ' js-enabled' : 'js-enabled');</script>

    <div class="app-pane">
      <div class="app-pane__header toc-open-disabled">
        <a href="#content" class="govuk-skip-link" data-module="govuk-skip-link">Skip to main content</a>

        <header class="govuk-header app-header" role="banner" data-module="govuk-header">
  <div class="govuk-header__container govuk-header__container--full-width">
    <div class="govuk-header__logo">
      <a href="https://planning.data.gov.uk" class="govuk-header__link govuk-header__link--homepage">
        <span class="govuk-header__product-name">
          Planning Data
        </span>
      </a>
        <strong class="govuk-tag">Beta</strong>
    </div>
  </div>
</header>

      </div>

        <div id="toc-heading" class="toc-show fixedsticky">
          <button type="button" class="toc-show__label js-toc-show" aria-controls="toc">
            Table of contents <span class="toc-show__icon"></span>
          </button>
        </div>

      <div class="app-pane__body" data-module="in-page-navigation">
          <div class="app-pane__toc">
            <div class="toc" data-module="table-of-contents" tabindex="-1" aria-label="Table of contents" role="dialog">
              <div class="search" data-module="search" data-path-to-site-root="./">
  <form action="https://www.google.co.uk/search" method="get" role="search" class="search__form govuk-!-margin-bottom-4">
    <input type="hidden" name="as_sitesearch" value="digital-land.github.io"/>
    <label class="govuk-label search__label" for="search" aria-hidden="true">
      Search (via Google)
    </label>
    <input
      type="text"
      id="search" name="q"
      class="govuk-input govuk-!-margin-bottom-0 search__input"
      aria-controls="search-results"
      placeholder="Search">
    <button type="submit" class="search__button">Search</button>
  </form>
</div>

              <button type="button" class="toc__close js-toc-close" aria-controls="toc" aria-label="Hide table of contents"></button>
              <nav id="toc" class="js-toc-list toc__list" aria-labelledby="toc-heading" data-module="collapsible-navigation">
                      <ul>
  <li>
    <a href="./index.html"><span>Planning Data Service</span></a>
  </li>
  <li>
    <a href="./documentation/index.html"><span>Documentation</span></a>
  </li>
<li><a href="./architecture/index.html"><span>Architecture</span></a>
<ul>
  <li>
    <a href="./architecture/decision-records/index.html"><span>Architecture Decision Records (ADRs)</span></a>
  </li>
<li><a href="./architecture/design/index.html"><span>Solution design index</span></a>
<ul>
<li><a href="./architecture/design/latest/index.html"><span>Solution design</span></a>
<ul>
  <li>
    <a href="./architecture/design/latest/data-pipelines/index.html"><span>Solution design - Data Pipelines</span></a>
  </li>
  <li>
    <a href="./architecture/design/latest/planning-data-platform/index.html"><span>Solution design - Planning Data Platform</span></a>
  </li>
  <li>
    <a href="./architecture/design/latest/publish-service/index.html"><span>Solution design - Publish Service</span></a>
  </li>
</ul>
</li>
<li><a href="./architecture/design/archive/index.html"><span>Solution design archive</span></a>
<ul>
  <li>
    <a href="./architecture/design/archive/2022-11/index.html"><span>Solution design - November 2022</span></a>
  </li>
</ul>
</li>
<li><a href="./architecture/design/proposals/index.html"><span>Open Design Proposals</span></a>
<ul>
  <li>
    <a href="./architecture/design/proposals/template.html"><span>Open Design Proposal - 00X - Title (Template)</span></a>
  </li>
  <li>
    <a href="./architecture/design/proposals/001-publish-async/index.html"><span>Open Design Proposal 001 - Publish service - Async</span></a>
  </li>
  <li>
    <a href="./architecture/design/proposals/002-data-pipelines-migration/index.html"><span>Open Design Proposal 002 - Data Pipelines Migration</span></a>
  </li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
  <li>
    <a href="./infrastructure.html"><span>Infrastructure</span></a>
  </li>
<li><a href="./data-operations-manual/index.html"><span>Data Operations Manual</span></a>
<ul>
<li><a href="./data-operations-manual/key-processes/index.html"><span>Key Processes</span></a>
<ul>
  <li>
    <a href="./data-operations-manual/key-processes/validate-endpoint.html"><span>Validating an Endpoint</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/add-endpoint.html"><span>Adding An Endpoint</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/add-collection.html"><span>Creating A Collection</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/add-dataset.html"><span>Adding A Dataset</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/end-endpoint.html"><span>Ending An Endpoint</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/retire-resource.html"><span>Retiring A Resource</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/assign-entities.html"><span>Assigning Entities</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/key-processes/merge-entities.html"><span>Merging Entities</span></a>
  </li>
</ul>
</li>
  <li>
    <a href="./data-operations-manual/key-concepts/index.html"><span>Key Concepts</span></a>
  </li>
  <li>
    <a href="./data-operations-manual/reference/index.html"><span>Reference</span></a>
  </li>
</ul>
</li>
  <li>
    <a href="./runbook.html"><span>Run Book</span></a>
  </li>
  <li>
    <a href="./WorkingWithLPA_GIS.html"><span>Working with LPA GIS Systems</span></a>
  </li>
  <li>
    <a href="./HowTos.html"><span>How-to Guides</span></a>
  </li>
</ul>


              </nav>
            </div>
          </div>

        <div class="app-pane__content toc-open-disabled" aria-label="Content" tabindex="0">
          <main id="content" class="technical-documentation" data-module="anchored-headings">
            <h1 id="working-with-lpa-gis-systems">Working with LPA GIS Systems</h1>
<p>Generally LPAs run one of a small number of GIS platforms. Most are compatible with some version of the OGC spec.</p>
<p>You need a small amount of info to work with these servers. This page is intended to give you some guidance.</p>
<h2 id="core-concepts">Core Concepts</h2>
<p>LPAs often provide data directly from a standards-compliant web server. You can query the server for data by building relatively simple query strings.</p>
<h2 id="terminology">Terminology</h2>

<ul>
<li>OGC - Open Geospatial Consortium. They define the standards. </li>
<li>WFS - Web Feature Service. Use this service to get data in eg csv or json formats</li>
<li>WMS - Web Map Service. Use this service to get maps as images etc</li>
<li>Feature - a thing on a map. You get them from making calls to WFS.</li>
<li>Feature Type - information about the features above. </li>
<li>QGIS - open-source mapping tools. Their desktop tool is great if you need to visualize your map data.</li>
</ul>
<p>There&rsquo;s broadly two kinds of query - one for maps -  (wms) and one for data that comprises maps, (wfs). We are going to focus on wfs.</p>
<p>You might get a suggested endpoint like <code>https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0</code> from an LPA. This is a pointer to their GIS. See &lsquo;WFS&rsquo; in there? We can also see that they&rsquo;re providing version 2.0.0 of the OGC spec.</p>
<p>What can you do with it?</p>
<h2 id="get-the-servers-cabilities">Get the servers cabilities</h2>
<p>If you add <code>&amp;request=GetCapabilities</code> onto the query, you will get back some XML that describes what the server can do.</p>
<p><a href="https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0&amp;request=GetCapabilities">Try it! - click <code>https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0&amp;request=GetCapabilities</code></a></p>
<p>This is important to us since it gives us some insight into what their server can provide. When you ran the query above you got some XML. As is typical for an XML document there&rsquo;s a lot of stuff in there but there&rsquo;s no need to understand all of it.</p>
<h3 id="interesting-useful-items-in-a-servers-capabilties">Interesting / useful items in a servers capabilties</h3>
<p>Look for the strings below in the XML:</p>

<ul>
<li>outputFormat - lets us know what the server claimes to produicve if requested</li>
<li>ImplementsResultPaging - some servers hold massive amounts of data that we might want to download in chunks</li>
<li>FeatureTypeList - super important. A FeatureType names the kind of data the server can offer. Eg <code>&lt;Name&gt;ns:DVL_ARTICLE_4&lt;/Name&gt;</code> is a clue we will be able to get Article 4 direction info.</li>
</ul>
<p>I scanned down the file looking for <code>FeatureTypeList</code> and found the Article 4 info - the first entry.</p>
<div class="highlight"><pre class="highlight xml" tabindex="0"><code><span class="nt">&lt;FeatureType&gt;</span>
    <span class="nt">&lt;Name&gt;</span>ns:DVL_ARTICLE_4<span class="nt">&lt;/Name&gt;</span>
    <span class="nt">&lt;Title&gt;</span>DVL_ARTICLE_4<span class="nt">&lt;/Title&gt;</span>
    <span class="nt">&lt;DefaultCRS&gt;</span>urn:ogc:def:crs:EPSG::27700<span class="nt">&lt;/DefaultCRS&gt;</span>
    <span class="nt">&lt;OtherCRS&gt;</span>urn:ogc:def:crs:EPSG::3857<span class="nt">&lt;/OtherCRS&gt;</span>
    <span class="nt">&lt;OtherCRS&gt;</span>urn:ogc:def:crs:EPSG::4277<span class="nt">&lt;/OtherCRS&gt;</span>
    <span class="nt">&lt;OtherCRS&gt;</span>urn:ogc:def:crs:EPSG::4326<span class="nt">&lt;/OtherCRS&gt;</span>
        <span class="nt">&lt;ows:WGS84BoundingBox&gt;</span>
            <span class="nt">&lt;ows:LowerCorner&gt;</span>-180 -89.9999<span class="nt">&lt;/ows:LowerCorner&gt;</span>
            <span class="nt">&lt;ows:UpperCorner&gt;</span>180 89.9999<span class="nt">&lt;/ows:UpperCorner&gt;</span>
        <span class="nt">&lt;/ows:WGS84BoundingBox&gt;</span>
<span class="nt">&lt;/FeatureType&gt;</span>
</code></pre></div><p>Not <em>massively</em> useful. The Name and Title and some stuff about coordinate systems and boundaries.</p>
<p>You can get more.</p>
<h3 id="getting-info-about-a-feature-type">Getting info about a Feature Type</h3>
<p><code>DescribeFeatureType</code> gives you the definition of a given feature type. You just need to provide the name of the Feature Type you want, without the <code>ns:</code> prefix:</p>
<p><code>&amp;request=DescribeFeatureType&amp;TypeNames=DVL_ARTICLE_4</code></p>
<p>For example</p>
<p><code>https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0&amp;request=DescribeFeatureType&amp;TypeNames=DVL_ARTICLE_4</code></p>
<p>Gives us a type definition. The best bit is that there is some info about the fields that Features of this FeatureType have:</p>
<div class="highlight"><pre class="highlight xml" tabindex="0"><code><span class="nt">&lt;xsd:complexType</span> <span class="na">name=</span><span class="s">"DVL_ARTICLE_4_Type"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;xsd:complexContent&gt;</span>
        <span class="nt">&lt;xsd:extension</span> <span class="na">base=</span><span class="s">"gml:AbstractFeatureType"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;xsd:sequence&gt;</span>
            <span class="nt">&lt;xsd:element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">name=</span><span class="s">"GML_Geometry"</span> <span class="na">nillable=</span><span class="s">"false"</span> <span class="na">type=</span><span class="s">"gml:GeometryPropertyType"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;xsd:element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">name=</span><span class="s">"ARTICLE"</span> <span class="na">nillable=</span><span class="s">"false"</span> <span class="na">type=</span><span class="s">"xsd:string"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;xsd:element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">name=</span><span class="s">"DATE122"</span> <span class="na">nillable=</span><span class="s">"false"</span> <span class="na">type=</span><span class="s">"xsd:string"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;xsd:element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">name=</span><span class="s">"NAME"</span> <span class="na">nillable=</span><span class="s">"false"</span> <span class="na">type=</span><span class="s">"xsd:string"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;xsd:element</span> <span class="na">maxOccurs=</span><span class="s">"1"</span> <span class="na">minOccurs=</span><span class="s">"0"</span> <span class="na">name=</span><span class="s">"REFERENCE"</span> <span class="na">nillable=</span><span class="s">"false"</span> <span class="na">type=</span><span class="s">"xsd:string"</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/xsd:sequence&gt;</span>
        <span class="nt">&lt;/xsd:extension&gt;</span>
    <span class="nt">&lt;/xsd:complexContent&gt;</span>
    <span class="nt">&lt;/xsd:complexType&gt;</span>
<span class="nt">&lt;xsd:element</span> <span class="na">name=</span><span class="s">"DVL_ARTICLE_4"</span> <span class="na">substitutionGroup=</span><span class="s">"gml:AbstractFeature"</span> <span class="na">type=</span><span class="s">"ns:DVL_ARTICLE_4_Type"</span><span class="nt">/&gt;</span>
</code></pre></div><p>This gives you some guidance on what column mappings you need to set up. In the above, NAME and REFERENCE are going to get automatically mapped. DATE122 though? We do not know which <a href="https://digital-land.github.io/specification/dataset/article-4-direction-area/">Article 4</a> Date that maps onto. To determine what we&rsquo;re going to do about that we can go and get the actual data.</p>
<h2 id="getting-some-map-data-for-a-feature-type">Getting some map data for a Feature Type</h2>
<p><a href="https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0&amp;request=GetFeature&amp;TypeNames=DVL_ARTICLE_4">Get the actual data - Click here! https://medwaymaps.medway.gov.uk/WFS/wfs.exe?service=WFS&amp;version=2.0.0&amp;request=GetFeature&amp;TypeNames=DVL_ARTICLE_4</a></p>
<p>This gives you the data in full XML format. Here&rsquo;s a single Feature - Upper Upnor(4):</p>
<div class="highlight"><pre class="highlight xml" tabindex="0"><code><span class="nt">&lt;wfs:member&gt;</span>
    <span class="nt">&lt;ns:DVL_ARTICLE_4</span> <span class="na">gml:id=</span><span class="s">"DVL_ARTICLE_4.1.1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;gml:description&gt;</span>Polygon<span class="nt">&lt;/gml:description&gt;</span>
    <span class="nt">&lt;gml:name&gt;</span>Polygon<span class="nt">&lt;/gml:name&gt;</span>
    <span class="nt">&lt;gml:boundedBy&gt;</span>
        <span class="nt">&lt;gml:Envelope</span> <span class="na">srsName=</span><span class="s">"EPSG:27700"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;gml:lowerCorner&gt;</span>575760.15 170442.45<span class="nt">&lt;/gml:lowerCorner&gt;</span>
            <span class="nt">&lt;gml:upperCorner&gt;</span>575810.78 170477.32<span class="nt">&lt;/gml:upperCorner&gt;</span>
        <span class="nt">&lt;/gml:Envelope&gt;</span>
    <span class="nt">&lt;/gml:boundedBy&gt;</span>
    <span class="nt">&lt;ns:GML_Geometry&gt;</span>
    <span class="nt">&lt;gml:Polygon</span> <span class="na">gml:id=</span><span class="s">"DVL_ARTICLE_4.1.1.Geometry"</span> <span class="na">srsName=</span><span class="s">"EPSG:27700"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;gml:exterior&gt;</span>
            <span class="nt">&lt;gml:LinearRing&gt;</span>
                <span class="nt">&lt;gml:coordinates&gt;</span>575777.46,170476.57 575781.07,170475.62 575781.74,170477.32
                ...
                 575776.35,170472.7 575777.46,170476.57<span class="nt">&lt;/gml:coordinates&gt;</span>
            <span class="nt">&lt;/gml:LinearRing&gt;</span>
        <span class="nt">&lt;/gml:exterior&gt;</span>
    <span class="nt">&lt;/gml:Polygon&gt;</span>
    <span class="nt">&lt;/ns:GML_Geometry&gt;</span>
    <span class="nt">&lt;ns:ARTICLE&gt;</span>Article 4(2)<span class="nt">&lt;/ns:ARTICLE&gt;</span>
    <span class="nt">&lt;ns:NAME&gt;</span>Upper Upnor(4)<span class="nt">&lt;/ns:NAME&gt;</span>
    <span class="nt">&lt;ns:REFERENCE&gt;</span>UPNOR04<span class="nt">&lt;/ns:REFERENCE&gt;</span>
    <span class="nt">&lt;/ns:DVL_ARTICLE_4&gt;</span>
<span class="nt">&lt;/wfs:member&gt;</span>
</code></pre></div><p>We can see NAME and REFERENCE but DATA122 is missing! Scanning the file for <code>ns:DATE122</code> leads to a number of occurrences. Not every Feature hasd a date, but where it is present the value is consitently associated with a particular NAME format. Examples below.</p>
<div class="highlight"><pre class="highlight xml" tabindex="0"><code><span class="nt">&lt;ns:DATE122&gt;</span>05/09/05<span class="nt">&lt;/ns:DATE122&gt;</span>
<span class="nt">&lt;ns:NAME&gt;</span>Upper Upnor(1)<span class="nt">&lt;/ns:NAME&gt;</span>
...
<span class="nt">&lt;ns:DATE122&gt;</span>05/09/05<span class="nt">&lt;/ns:DATE122&gt;</span>
<span class="nt">&lt;ns:NAME&gt;</span>Upper Upnor(2)<span class="nt">&lt;/ns:NAME&gt;</span>
</code></pre></div><p>And so forth. At this point I might believe that this is the start data for the articl 4 direction item. We don&rsquo;t have a documentation URL though so I cannot check. This is the end of the road for this particular dataset until we get some clarity from Medway about the meaning of DATE122!</p>
<h2 id="useful-links">Useful links</h2>
<p><a href="https://docs.qgis.org/3.28/en/docs/server_manual/services.html">QGIS services reference</a></p>

            
          </main>

          <aside>
          </aside>

          <footer class="govuk-footer app-footer" role="contentinfo">
  <div class="govuk-footer__meta">
    <div class="govuk-footer__meta-item govuk-footer__meta-item--grow">


      <svg
        aria-hidden="true"
        focusable="false"
        class="govuk-footer__licence-logo"
        xmlns="http://www.w3.org/2000/svg"
        viewbox="0 0 483.2 195.7"
        height="17"
        width="41"
      >
        <path
          fill="currentColor"
          d="M421.5 142.8V.1l-50.7 32.3v161.1h112.4v-50.7zm-122.3-9.6A47.12 47.12 0 0 1 221 97.8c0-26 21.1-47.1 47.1-47.1 16.7 0 31.4 8.7 39.7 21.8l42.7-27.2A97.63 97.63 0 0 0 268.1 0c-36.5 0-68.3 20.1-85.1 49.7A98 98 0 0 0 97.8 0C43.9 0 0 43.9 0 97.8s43.9 97.8 97.8 97.8c36.5 0 68.3-20.1 85.1-49.7a97.76 97.76 0 0 0 149.6 25.4l19.4 22.2h3v-87.8h-80l24.3 27.5zM97.8 145c-26 0-47.1-21.1-47.1-47.1s21.1-47.1 47.1-47.1 47.2 21 47.2 47S123.8 145 97.8 145"
        />
      </svg>
      <span class="govuk-footer__licence-description">
        All content is available under the
        <a
          class="govuk-footer__link"
          href="https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/"
          rel="license"
        >Open Government Licence v3.0</a>, except where otherwise stated
      </span>
    </div>
    <div class="govuk-footer__meta-item">
      <a
        class="govuk-footer__link govuk-footer__copyright-logo"
        href="https://www.nationalarchives.gov.uk/information-management/re-using-public-sector-information/uk-government-licensing-framework/crown-copyright/"
      >Â© Crown copyright</a>
    </div>
  </div>
</footer>

        </div>
      </div>
    </div>

    
    <script src="javascripts/application.js"></script>
  </body>
</html>
